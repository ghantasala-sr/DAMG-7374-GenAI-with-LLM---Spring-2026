-- Create database and schema
CREATE DATABASE IF NOT EXISTS DBT_TUTORIAL;
USE DATABASE DBT_TUTORIAL;
CREATE SCHEMA IF NOT EXISTS RAW;
USE SCHEMA RAW;

-- Create customers table
CREATE OR REPLACE TABLE CUSTOMERS (
    ID NUMBER,
    FIRST_NAME VARCHAR,
    LAST_NAME VARCHAR
);

-- Insert sample data into customers
INSERT INTO CUSTOMERS (ID, FIRST_NAME, LAST_NAME) VALUES
    (1, 'James', 'Smith'),
    (2, 'Mary', 'Johnson'),
    (3, 'Robert', 'Williams'),
    (4, 'Patricia', 'Brown'),
    (5, 'John', 'Jones'),
    (6, 'Jennifer', 'Garcia'),
    (7, 'Michael', 'Miller'),
    (8, 'Linda', 'Davis'),
    (9, 'David', 'Rodriguez'),
    (10, 'Elizabeth', 'Martinez'),
    (11, 'William', 'Hernandez'),
    (12, 'Barbara', 'Lopez'),
    (13, 'Richard', 'Gonzalez'),
    (14, 'Susan', 'Wilson'),
    (15, 'Joseph', 'Anderson'),
    (16, 'Jessica', 'Thomas'),
    (17, 'Thomas', 'Taylor'),
    (18, 'Sarah', 'Moore'),
    (19, 'Charles', 'Jackson'),
    (20, 'Karen', 'Martin'),
    (21, 'Christopher', 'Lee'),
    (22, 'Nancy', 'Perez'),
    (23, 'Daniel', 'Thompson'),
    (24, 'Lisa', 'White'),
    (25, 'Matthew', 'Harris'),
    (26, 'Betty', 'Sanchez'),
    (27, 'Anthony', 'Clark'),
    (28, 'Margaret', 'Ramirez'),
    (29, 'Mark', 'Lewis'),
    (30, 'Sandra', 'Robinson'),
    (31, 'Donald', 'Walker'),
    (32, 'Ashley', 'Young'),
    (33, 'Steven', 'Allen'),
    (34, 'Kimberly', 'King'),
    (35, 'Paul', 'Wright'),
    (36, 'Emily', 'Scott'),
    (37, 'Andrew', 'Torres'),
    (38, 'Donna', 'Nguyen'),
    (39, 'Joshua', 'Hill'),
    (40, 'Michelle', 'Flores'),
    (41, 'Kenneth', 'Green'),
    (42, 'Dorothy', 'Adams'),
    (43, 'Kevin', 'Nelson'),
    (44, 'Carol', 'Baker'),
    (45, 'Brian', 'Hall'),
    (46, 'Amanda', 'Rivera'),
    (47, 'George', 'Campbell'),
    (48, 'Melissa', 'Mitchell'),
    (49, 'Edward', 'Carter'),
    (50, 'Deborah', 'Roberts');

-- Create orders table
CREATE OR REPLACE TABLE ORDERS (
    ID NUMBER,
    USER_ID NUMBER,
    ORDER_DATE DATE,
    STATUS VARCHAR
);

-- Insert sample data into orders
INSERT INTO ORDERS (ID, USER_ID, ORDER_DATE, STATUS) VALUES
    (1, 14, '2018-08-05', 'return_pending'),
    (2, 24, '2018-05-25', 'placed'),
    (3, 40, '2018-10-22', 'placed'),
    (4, 29, '2018-12-23', 'shipped'),
    (5, 44, '2018-06-02', 'shipped'),
    (6, 30, '2018-02-01', 'return_pending'),
    (7, 5, '2018-07-31', 'returned'),
    (8, 2, '2018-06-11', 'completed'),
    (9, 18, '2018-02-02', 'completed'),
    (10, 46, '2018-08-20', 'completed'),
    (11, 25, '2018-07-06', 'placed'),
    (12, 7, '2018-02-06', 'completed'),
    (13, 30, '2018-09-18', 'return_pending'),
    (14, 38, '2018-01-18', 'completed'),
    (15, 50, '2018-11-16', 'completed'),
    (16, 41, '2018-01-21', 'returned'),
    (17, 6, '2018-06-14', 'completed'),
    (18, 23, '2018-07-21', 'completed'),
    (19, 50, '2018-09-27', 'returned'),
    (20, 18, '2018-01-05', 'completed'),
    (21, 32, '2018-05-20', 'placed'),
    (22, 22, '2018-06-21', 'placed'),
    (23, 13, '2018-11-30', 'return_pending'),
    (24, 37, '2018-05-16', 'completed'),
    (25, 10, '2018-05-19', 'returned'),
    (26, 48, '2018-05-11', 'shipped'),
    (27, 48, '2018-01-18', 'return_pending'),
    (28, 17, '2018-11-09', 'placed'),
    (29, 41, '2018-02-25', 'returned'),
    (30, 44, '2018-01-07', 'returned'),
    (31, 18, '2018-05-28', 'placed'),
    (32, 15, '2018-02-25', 'completed'),
    (33, 36, '2018-09-12', 'placed'),
    (34, 48, '2018-10-16', 'completed'),
    (35, 31, '2018-06-02', 'return_pending'),
    (36, 34, '2018-05-21', 'shipped'),
    (37, 26, '2018-05-30', 'completed'),
    (38, 37, '2018-02-02', 'shipped'),
    (39, 9, '2018-06-09', 'placed'),
    (40, 28, '2018-08-15', 'completed'),
    (41, 8, '2018-04-30', 'returned'),
    (42, 29, '2018-12-08', 'placed'),
    (43, 36, '2018-03-24', 'placed'),
    (44, 22, '2018-10-10', 'return_pending'),
    (45, 2, '2018-01-09', 'return_pending'),
    (46, 38, '2018-05-24', 'placed'),
    (47, 21, '2018-06-26', 'completed'),
    (48, 46, '2018-12-29', 'returned'),
    (49, 34, '2018-07-09', 'shipped'),
    (50, 2, '2018-02-04', 'return_pending'),
    (51, 36, '2018-03-27', 'shipped'),
    (52, 6, '2018-05-01', 'placed'),
    (53, 5, '2018-01-30', 'shipped'),
    (54, 16, '2018-03-11', 'completed'),
    (55, 28, '2018-04-13', 'shipped'),
    (56, 26, '2018-09-11', 'returned'),
    (57, 32, '2018-02-25', 'placed'),
    (58, 49, '2018-06-14', 'shipped'),
    (59, 14, '2018-01-19', 'return_pending'),
    (60, 23, '2018-10-01', 'placed');

-- Create payments table
CREATE OR REPLACE TABLE PAYMENTS (
    ID NUMBER,
    ORDER_ID NUMBER,
    PAYMENT_METHOD VARCHAR,
    AMOUNT NUMBER -- stored in cents
);

-- Insert sample data into payments
INSERT INTO PAYMENTS (ID, ORDER_ID, PAYMENT_METHOD, AMOUNT) VALUES
    (1, 1, 'credit_card', 5648),
    (2, 2, 'coupon', 2110),
    (3, 3, 'coupon', 273),
    (4, 4, 'credit_card', 6197),
    (5, 5, 'gift_card', 178),
    (6, 6, 'coupon', 9160),
    (7, 7, 'gift_card', 319),
    (8, 8, 'bank_transfer', 9404),
    (9, 9, 'bank_transfer', 2372),
    (10, 10, 'bank_transfer', 5136),
    (11, 11, 'gift_card', 9010),
    (12, 12, 'gift_card', 952),
    (13, 13, 'credit_card', 590),
    (14, 14, 'coupon', 573),
    (15, 15, 'bank_transfer', 9996),
    (16, 16, 'gift_card', 1482),
    (17, 17, 'coupon', 618),
    (18, 18, 'bank_transfer', 4427),
    (19, 19, 'coupon', 5195),
    (20, 20, 'coupon', 5978),
    (21, 21, 'coupon', 2308),
    (22, 22, 'bank_transfer', 6840),
    (23, 23, 'coupon', 4736),
    (24, 24, 'gift_card', 3007),
    (25, 25, 'credit_card', 6626),
    (26, 26, 'credit_card', 6819),
    (27, 27, 'coupon', 4980),
    (28, 28, 'bank_transfer', 3721),
    (29, 29, 'credit_card', 8345),
    (30, 30, 'coupon', 7311),
    (31, 31, 'credit_card', 1514),
    (32, 32, 'gift_card', 5792),
    (33, 33, 'gift_card', 3971),
    (34, 34, 'bank_transfer', 7220),
    (35, 35, 'gift_card', 4843),
    (36, 36, 'credit_card', 6655),
    (37, 37, 'gift_card', 7276),
    (38, 38, 'credit_card', 1673),
    (39, 39, 'credit_card', 410),
    (40, 40, 'credit_card', 8167),
    (41, 41, 'coupon', 3043),
    (42, 42, 'coupon', 6554),
    (43, 43, 'gift_card', 3105),
    (44, 44, 'coupon', 3353),
    (45, 45, 'coupon', 6630),
    (46, 46, 'gift_card', 5654),
    (47, 47, 'gift_card', 1870),
    (48, 48, 'credit_card', 2191),
    (49, 49, 'credit_card', 4377),
    (50, 50, 'gift_card', 9989),
    (51, 51, 'bank_transfer', 9620),
    (52, 52, 'credit_card', 4900),
    (53, 53, 'credit_card', 6499),
    (54, 54, 'coupon', 7197),
    (55, 55, 'credit_card', 7446),
    (56, 56, 'gift_card', 3873),
    (57, 57, 'credit_card', 2174),
    (58, 58, 'coupon', 9488),
    (59, 59, 'bank_transfer', 2308),
    (60, 60, 'coupon', 8429);